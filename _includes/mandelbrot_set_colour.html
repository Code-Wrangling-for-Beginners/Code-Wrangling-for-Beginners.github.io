<html><body><pre>
<span style="color: #E2661A;">color</span> generatePixel(<span style="color: #E2661A;">int</span> x, <span style="color: #E2661A;">int</span> y, <span style="color: #E2661A;">int</span> w, <span style="color: #E2661A;">int</span> h)
{
&nbsp;&nbsp;<span style="color: #E2661A;">float</span> u = <span style="color: #006699;">map</span>(x, 0,w, 0.375,0.4);
&nbsp;&nbsp;<span style="color: #E2661A;">float</span> v = <span style="color: #006699;">map</span>(y, 0,h, 0.25,0.275);
&nbsp;&nbsp;<span style="color: #E2661A;">int</span> n=0;
&nbsp;&nbsp;<span style="color: #E2661A;">float</span> cx = 0.0;
&nbsp;&nbsp;<span style="color: #E2661A;">float</span> cy = 0.0;
&nbsp;&nbsp;<span style="color: #669900;">while</span>( cx*cx+cy*cy &lt; 4 &amp;&amp; n&lt;palette.<span style="color: #D94A7A;">width</span> ) {
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #E2661A;">float</span> xt = cx*cx - cy*cy + u;
&nbsp;&nbsp;&nbsp;&nbsp;cy&nbsp;=&nbsp;2*cx*cy&nbsp;+&nbsp;v;
&nbsp;&nbsp;&nbsp;&nbsp;cx&nbsp;=&nbsp;xt;
&nbsp;&nbsp;&nbsp;&nbsp;n++;
&nbsp;&nbsp;}
&nbsp;&nbsp;<span style="color: #33997E;">return</span> palette.<span style="color: #D94A7A;">pixels</span>[n];
}

<span style="color: #E2661A;">PImage</span> picture;
<span style="color: #E2661A;">PImage</span> palette;

<span style="color: #33997E;">void</span> <span style="color: #006699;"><b>setup</b></span>()
{
&nbsp;&nbsp;<span style="color: #006699;">size</span>(400,400);
&nbsp;&nbsp;picture = <span style="color: #006699;">createImage</span>(<span style="color: #D94A7A;">width</span>,<span style="color: #D94A7A;">height</span>,<span style="color: #718A62;">RGB</span>);
&nbsp;&nbsp;palette&nbsp;=&nbsp;<span style="color: #006699;">loadImage</span>(<span style="color: #7D4793;">&quot;visspec.png&quot;</span>);
&nbsp;&nbsp;palette.<span style="color: #006699;">loadPixels</span>();

&nbsp;&nbsp;picture&nbsp;=&nbsp;generatePicture(picture);
}

<span style="color: #33997E;">void</span> <span style="color: #006699;"><b>draw</b></span>()
{
&nbsp;&nbsp;<span style="color: #006699;">image</span>(picture,0,0);
}

<span style="color: #E2661A;">PImage</span> generatePicture(<span style="color: #E2661A;">PImage</span> pic)
{
&nbsp;&nbsp;pic.<span style="color: #006699;">loadPixels</span>();
&nbsp;&nbsp;<span style="color: #669900;">for</span>(<span style="color: #E2661A;">int</span> i=0; i&lt;pic.<span style="color: #D94A7A;">pixels</span>.<span style="color: #33997E;">length</span> ; i++) {
&nbsp;&nbsp;&nbsp;&nbsp;pic.<span style="color: #D94A7A;">pixels</span>[i] = generatePixel(i%pic.<span style="color: #D94A7A;">width</span>, i/pic.<span style="color: #D94A7A;">width</span>, pic.<span style="color: #D94A7A;">width</span>, pic.<span style="color: #D94A7A;">height</span>);
&nbsp;&nbsp;}
&nbsp;&nbsp;pic.<span style="color: #006699;">updatePixels</span>();
&nbsp;&nbsp;<span style="color: #33997E;">return</span> pic;
}
</pre></body></html>
<html><body><pre>
<span style="color: #D94A7A;">width</span>,<span style="color: #D94A7A;">height</span>

</pre></body></html>
